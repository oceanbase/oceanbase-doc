| description ||
|---|---|
| keywords ||
| dir-name ||
| dir-name-en ||
| tenant-type | Oracle Mode |

# Enable security audit

This topic describes how to enable security audit and set the storage location for audit records.

You can perform audit operations in OceanBase Database as the `ORAAUDITOR` user. The password and privileges of this user are specified by the `SYS` user.

## Limitations

Currently, only the Oracle mode of OceanBase Database supports the security audit feature.

## Procedure

1. Log on to an Oracle tenant as the `sys` user and unlock the `ORAAUDITOR` user.

   ```shell
   obclient> ALTER USER ORAAUDITOR ACCOUNT UNLOCK;
   ```

   <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>OceanBase Database automatically creates the <code>ORAAUDITOR</code> user. This user is locked by default and needs to be unlocked before you enable security audit. </p>
   </main>

2. Change the logon password of the `ORAAUDITOR` user.

   For security purposes, the password of the `ORAAUDITOR` user is specified by the `sys` user. You can change the password based on your business needs.

   ```shell
   obclient> ALTER USER ORAAUDITOR IDENTIFIED BY ******;
   ```

3. Grant privileges to the `ORAAUDITOR` user.

   By default, the `ORAAUDITOR` user is not granted any privileges. You must execute the `GRANT` statement to grant the `CREATE SESSION` privilege to the `ORAAUDITOR` user before you can perform audit operations. If you allow the `ORAAUDITOR` user to view audit records, grant the `SELECT ANY DICTIONARY` privilege to the user.

   ```shell
   obclient> GRANT CREATE SESSION, SELECT ANY DICTIONARY TO ORAAUDITOR;
   ```

4. Enable security audit and set the storage location for audit records.

   The security audit feature is controlled by the `audit_trail` parameter. The configuration takes effect immediately after this parameter is set. The valid values of this parameter are as follows:

   * `NONE`: disables security audit. This is the default value.

   * `OS`: writes audit records to local disk files.

   * `DB`: writes audit records to internal tables.

   * `DB,EXTENDED / DB_EXTENDED`: writes audit records (including executed SQL statements) to internal tables.

   Here is an example:

   ```shell
   obclient> ALTER SYSTEM SET audit_trail = 'DB,EXTENDED';
   ```

   For more information about the `audit_trail` parameter, see [audit_trail](../../../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/400.audit_trail.md).

      <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>You can choose an internal table or a local disk file to store the audit records.</p>
      <ul>
      <li>If you choose to write audit records into a local disk file, the audit records are written into <code>/audit/</code> under the installation directory in asynchronous write mode. The default path of the file is <code>/home/admin/oceanbase/audit/observer_xx_xxxxxx.aud</code>. </li>
      <li>If you choose to write audit records into an internal table, OceanBase Database automatically writes audit records into the system table. The internal table <code>__all_tenant_security_audit_record</code> stores the audit records. The internal table <code>__all_virtual_audit_operation</code> or <code>__all_virtual_audit_action</code> stores mappings of <code>IDs</code> and <code>names</code> related to the audit. </li>
      </ul>
   </main>

## What to do next

You can set audit rules after you enable security audit. For more information about how to set audit rules, see [Set and view audit rules](../600.security-audit/300.set-up-and-view-audit-rules.md).

  <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>Auditing starts only after the <code>ORAAUDITOR</code> user sets audit rules. </p>
   </main>

## References

For more information about audit operations, see the following topics:

* [Set and view audit rules](../600.security-audit/300.set-up-and-view-audit-rules.md)
* [View audit records](../600.security-audit/500.audit-records.md)