| description ||
|---|---|
| keywords ||
| dir-name ||
| dir-name-en ||
| tenant-type ||

# CDB_MVIEWS

<main id="notice" type='explain'>
<h4>Note</h4>
<p>This view is introduced since OceanBase Database V4.3.0. </p>
</main>

## Purpose

The `CDB_MVIEWS` view displays information about all materialized views.

## Columns

| **Column** | **Type** | **Nullable?** | **Description** |
| --- | --- | --- | --- |
| TENANT_ID | bigint(20) | NO | The ID of the tenant. |
| OWNER | varchar(128) | NO | The owner of the materialized view. |
| MVIEW_NAME | varchar(128) | NO | The name of the materialized view. |
| CONTAINER_NAME | varchar(128) | NO | The name of the container table of the materialized view. |
| QUERY | longtext | NO | The query that defines the materialized view. |
| QUERY_LEN | bigint(20) | NO | The length of the query that defines the materialized view, in bytes. |
| UPDATABLE | varchar(1) | NO | Indicates whether the materialized view can be updated. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UPDATE_LOG | varchar(128) | NO | The name of the update log file, if the materialized view can be updated.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| MASTER_ROLLBACK_SEG | varchar(128) | NO | The rollback segment of the master site or master materialized view site.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| MASTER_LINK | varchar(128) | NO | The database link of the master site or master materialized view site.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| REWRITE_ENABLED | varchar(1) | NO | Indicates whether rewrite is enabled. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| REWRITE_CAPABILITY | varchar(9) | NO | Indicates whether the materialized view meets the rewrite conditions. Valid values:<ul><li>`NONE`: The materialized view cannot be used for query rewrites because rewrites are not allowed or are blocked.  </li><li>`TEXTMATCH`: The query that defines the materialized view contains the restrictions on using query rewrites. </li><li>`GENERAL`: The query that defines the materialized view does not contain the restrictions on using query rewrites. </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| REFRESH_MODE | varchar(6) | NO | The mode for refreshing the materialized view. Valid values:<ul><li>`DEMAND`: The materialized view is refreshed by calling the refresh procedure.  </li><li>`NEVER`: The materialized view is never refreshed. </li></ul> |
| REFRESH_METHOD | varchar(8) | NO | The default method for refreshing the materialized view, which can be overridden by using an API. Valid values:<ul><li>`COMPLETE`: The materialized view is completely refreshed.  </li><li>`FORCE`: A fast refresh is performed if possible. Otherwise, a complete refresh is performed. </li><li>`FAST`: The materialized view is fast refreshed. </li><li>`NEVER`: The materialized view is never refreshed. </li></ul> |
| BUILD_MODE | varchar(9) | NO | The mode for populating the materialized view during creation. Valid values:<ul><li>`IMMEDIATE`: The materialized view is immediately populated during creation.  </li><li>`DEFERRED`: The materialized view is not populated during creation. </li><li>`PREBUILT`: The materialized view is populated based on existing tables during creation. </li></ul> |
| FAST_REFRESHABLE | varchar(18) | NO | Indicates whether the materialized view is eligible for incremental (fast) refreshes. Valid values:<ul><li>`NO`: The materialized view cannot be fast refreshed and therefore is complex.  </li><li>`DML`: Fast refreshes are supported only for DML operations.</li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| LAST_REFRESH_TYPE | varchar(8) | NO | The method used for the last refresh. Valid values:<ul><li>`COMPLETE`: The materialized view was completely refreshed.  </li><li>`FAST`: The materialized view was fast refreshed. </li><li>`NA`: The materialized view has not been refreshed. For example, the materialized view was created in DEFERRED mode. </li></ul> |
| LAST_REFRESH_DATE | datetime | YES | The date when the materialized view was last refreshed. |
| LAST_REFRESH_END_TIME | datetime | NO | The time when the last refresh of the materialized view ended. |
| STALENESS | varchar(19) | NO | The relationship between the content of the materialized view and that of the masters of the materialized view. Valid values:<ul><li>`FRESH`: The materialized view is a read-consistent view of its masters in the current state.  </li><li>`IMPORT`: The materialized view is imported from another database. In this case, the value of the `UNKNOWN_IMPORT` column is `Y`. Therefore, it is unknown whether the materialized view is a read-consistent view of its masters at any point in time. After a complete refresh, the `STALENESS` value of the view changes to `FRESH`.  </li><li>`NEEDS_COMPILE`: Some objects on which the materialized view depends have changed. In this case, you must execute the `ALTER MATERIALIZED VIEW...COMPILE` statement to verify this materialized view and calculate the staleness of its data.  </li><li>`STALE`: The materialized view is stale because one or more of its masters have changed. If the `STALENESS` value of the materialized view changes from `FRESH` to `STALE`, the materialized view is a read-consistent view of its masters in an earlier state.  </li><li>`UNDEFINED`: The materialized view has remote masters. The concept of staleness is not defined for this type of materialized views.  </li><li>`UNKNOWN`: It is unknown whether the materialized view is a read-consistent view of its masters at any point in time. </li><li>`UNUSABLE`: The materialized view is not a read-consistent view of its masters at any point in time. </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| AFTER_FAST_REFRESH | varchar(19) | NO | The `STALENESS` value when the materialized view is fast refreshed, which is the same as the value of the `STALENESS` column. The value `NA` indicates that fast refresh is not supported for the materialized view. <main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| UNKNOWN_PREBUILT | varchar(1) | NO | Indicates whether the materialized view was prebuilt. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UNKNOWN_PLSQL_FUNC | varchar(1) | NO | Indicates whether the materialized view contains PL/SQL functions. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UNKNOWN_EXTERNAL_TABLE | varchar(1) | NO | Indicates whether the materialized view contains external tables. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UNKNOWN_CONSIDER_FRESH | varchar(1) | NO | Indicates whether the materialized view is considered fresh. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UNKNOWN_IMPORT | varchar(1) | NO | Indicates whether the materialized view was imported from another database. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| UNKNOWN_TRUSTED_FD | varchar(1) | NO | Indicates whether trusted constraints are used to refresh the materialized view. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |
| COMPILE_STATE | varchar(19) | NO | The validity of the materialized view with respect to the objects on which it depends. Valid values:<ul><li>`VALID`: The materialized view has been verified and no errors were found. In addition, the objects on which the materialized view depends have not changed since the last verification. <li><li>`NEEDS_COMPILE`: Some objects on which the materialized view depends have changed.  In this case, you must execute the `ALTER MATERIALIZED VIEW...COMPILE` statement to verify this materialized view.  </li><li>`ERROR`: The materialized view has been verified and one or more errors were found.  </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| USE_NO_INDEX | varchar(1) | NO | Indicates whether the materialized view was created by using the `USING NO INDEX` clause (`Y`) or the default index (`N`). You cannot create a default index when you use the `USING NO INDEX` clause. <ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `Y` by default. </p></main> |
| STALE_SINCE | datetime | NO | The time since when the materialized view became stale.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| NUM_PCT_TABLES | bigint(0) | NO | The number of PCT base tables.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| NUM_FRESH_PCT_REGIONS | bigint(0) | NO | The number of fresh PCT partition regions.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| NUM_STALE_PCT_REGIONS | bigint(0) | NO | The number of stale PCT partition regions.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| SEGMENT_CREATED | varchar(3) | NO | Indicates whether the materialized view was created by using the `SEGMENT CREATION DEFERRED` clause. Valid values: <ul><li> YES </li><li>NO </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NO` by default. </p></main> |
| EVALUATION_EDITION | varchar(128) | NO | The edition in which editioned objects referenced in an expression column are resolved.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| UNUSABLE_BEFORE | varchar(128) | NO | The earliest edition in which the stored results of subqueries on the materialized view can be used for query rewrites. In an edition earlier than the specified edition, the stored query results of the materialized view are considered as unavailable.  If no such edition is specified, the value is `NULL`. <main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| UNUSABLE_BEGINNING | varchar(128) | NO | The earliest edition in which the stored results of subqueries on the materialized view cannot be used for query rewrites. In the specified edition and later editions, the data cannot be used for query rewrites.  If no such edition is specified, the value is `NULL`. <main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| DEFAULT_COLLATION | varchar(100) | NO | The default collation for the materialized view.<main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `NULL` by default. </p></main> |
| ON_QUERY_COMPUTATION | varchar(1) | NO | Indicates whether the materialized view is a real-time view. Valid values:<ul><li> Y </li><li>N </li></ul><main id="notice" type='explain'> <h4>Note</h4><p>This column is used only for compatibility and is `N` by default. </p></main> |

## Sample query

```shell
obclient [test_db]> SELECT * FROM oceanbase.CDB_MVIEWS limit 1;
```

The query result is as follows:

```shell
+-----------+---------+---------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+-----------+------------+---------------------+-------------+-----------------+--------------------+--------------+----------------+------------+------------------+-------------------+---------------------+-----------------------+-----------+--------------------+------------------+--------------------+------------------------+------------------------+----------------+--------------------+---------------+--------------+-------------+----------------+-----------------------+-----------------------+-----------------+--------------------+-----------------+--------------------+-------------------+----------------------+
| TENANT_ID | OWNER   | MVIEW_NAME    | CONTAINER_NAME        | QUERY                                                                                                                                                                | QUERY_LEN | UPDATABLE | UPDATE_LOG | MASTER_ROLLBACK_SEG | MASTER_LINK | REWRITE_ENABLED | REWRITE_CAPABILITY | REFRESH_MODE | REFRESH_METHOD | BUILD_MODE | FAST_REFRESHABLE | LAST_REFRESH_TYPE | LAST_REFRESH_DATE   | LAST_REFRESH_END_TIME | STALENESS | AFTER_FAST_REFRESH | UNKNOWN_PREBUILT | UNKNOWN_PLSQL_FUNC | UNKNOWN_EXTERNAL_TABLE | UNKNOWN_CONSIDER_FRESH | UNKNOWN_IMPORT | UNKNOWN_TRUSTED_FD | COMPILE_STATE | USE_NO_INDEX | STALE_SINCE | NUM_PCT_TABLES | NUM_FRESH_PCT_REGIONS | NUM_STALE_PCT_REGIONS | SEGMENT_CREATED | EVALUATION_EDITION | UNUSABLE_BEFORE | UNUSABLE_BEGINNING | DEFAULT_COLLATION | ON_QUERY_COMPUTATION |
+-----------+---------+---------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+-----------+------------+---------------------+-------------+-----------------+--------------------+--------------+----------------+------------+------------------+-------------------+---------------------+-----------------------+-----------+--------------------+------------------+--------------------+------------------------+------------------------+----------------+--------------------+---------------+--------------+-------------+----------------+-----------------------+-----------------------+-----------------+--------------------+-----------------+--------------------+-------------------+----------------------+
|      1002 | test_db | mv1_tbl1_tbl2 | __mv_container_500025 | select `t1`.`id` AS `id`,`t1`.`name` AS `name`,`t2`.`notes` AS `notes` from `test_db`.`test_tbl1` `t1`,`test_db`.`test_tbl2` `t2` where (`t1`.`id` = `t2`.`tbl1_id`) |       164 | N         | NULL       | NULL                | NULL        | N               | NULL               | DEMAND       | COMPLETE       | IMMEDIATE  | NULL             | COMPLETE          | 2024-01-17 16:26:28 | 2024-01-17 16:26:28   | NULL      | NULL               | N                | N                  | N                      | N                      | N              | N                  | NULL          | Y            | NULL        |           NULL |                  NULL |                  NULL | NO              | NULL               | NULL            | NULL               | NULL              | N                    |
+-----------+---------+---------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+-----------+------------+---------------------+-------------+-----------------+--------------------+--------------+----------------+------------+------------------+-------------------+---------------------+-----------------------+-----------+--------------------+------------------+--------------------+------------------------+------------------------+----------------+--------------------+---------------+--------------+-------------+----------------+-----------------------+-----------------------+-----------------+--------------------+-----------------+--------------------+-------------------+----------------------+
1 row in set (0.090 sec)
```
