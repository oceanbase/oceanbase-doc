|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|

# Temporary tables

A temporary table stores data that exists only during a transaction or session. This topic describes how to create a global temporary table (GTT) in OceanBase Database.

## What is a global temporary table?

A global temporary table stores data for a specific period of time, which can be the lifecycle of a transaction or session.

A global temporary table can be visible to all sessions. However, data in the global temporary table is private to a session, and the session can access and modify only its own data.

For example, a course schedule application enables a college student to create semester schedules. Each row in the GTT represents a course schedule. During the session, the course schedule data is private to the session. When the student confirms a course schedule, the application moves the row of the selected schedule to a normal table. When the session ends, the database automatically deletes data in the GTT.

## Create a global temporary table

You can create a global temporary table using the `CREATE GLOBAL TEMPORARY TABLE` statement. The `ON COMMIT` clause specifies whether to create a transaction- or session-level temporary table, as detailed below:

* `ON COMMIT DELETE ROWS`: Transaction-level temporary table, where data is deleted upon transaction commit.
* `ON COMMIT PRESERVE ROWS`: Session-level temporary table, where data is deleted at the end of the session.

Global temporary tables can have indexes created on them. The index data for global temporary tables is also temporary and is private to the session.

## Examples

### Example 1: Create a transaction-level temporary table

1. Create a transaction-level temporary table `tbl1`.

    ```shell
    obclient [SYS]> CREATE GLOBAL TEMPORARY TABLE tbl1(col1 INT) ON COMMIT DELETE ROWS;
    ```

2. Insert a row into the temporary table `tbl1`.

    ```shell
    obclient [SYS]> INSERT INTO tbl1 VALUES(1);
    ```

3. Query the data in the temporary table `tbl1`.

    ```shell
    obclient [SYS]> SELECT * FROM tbl1;
    ```

    The result is as follows:

    ```shell
    +------+
    | COL1 |
    +------+
    |    1 |
    +------+
    1 row in set
    ```

4. Commit the transaction.

    ```shell
    obclient [SYS]> COMMIT;
    ```

5. Query the data in the temporary table `tbl1` again.

    ```shell
    obclient [SYS]> SELECT * FROM tbl1;
    ```

    The result is as follows:

    ```shell
    Empty set
    ```

### Example 2: Create a session-Level temporary table

**In Session 1, perform the following operations:**

1. Create a session-level temporary table `tbl2`.

    ```shell
    obclient [SYS]> CREATE GLOBAL TEMPORARY TABLE tbl2(col1 INT) ON COMMIT PRESERVE ROWS;
    ```

2. Insert a row into the temporary table `tbl2`.

    ```shell
    obclient [SYS]> INSERT INTO tbl2 VALUES(1);
    ```

3. Query the data in the temporary table `tbl2`.

    ```shell
    obclient [SYS]> SELECT * FROM tbl2;
    ```

    The result is as follows:

    ```shell
    +------+
    | COL1 |
    +------+
    |    1 |
    +------+
    1 row in set
    ```

4. Commit the transaction.

    ```shell
    obclient [SYS]> COMMIT;
    ```

5. Query the data in the temporary table `tbl2` again.

    ```shell
    obclient [SYS]> SELECT * FROM tbl2;
    ```

    The result is as follows:

    ```shell
    +------+
    | COL1 |
    +------+
    |    1 |
    +------+
    1 row in set
    ```

**In Session 2, perform the following operations. You can also perform the operations after exiting Session 1 and reconnecting to the database.**

Query the data in the temporary table `tbl2`.

```shell
obclient [SYS]> SELECT * FROM tbl2;
```

The result is as follows:

```shell
Empty set
```

## References

[CREATE TABLE](../../../../500.sql-reference/100.sql-syntax/300.common-tenant-of-oracle-mode/900.sql-statement-of-oracle-mode/100.ddl-of-oracle-mode/2400.create-table-of-oracle-mode.md)
