# 服务器配置

本节主要介绍服务器的硬件设置要求，包括操作系统、BIOS 设置、磁盘挂载、网卡设置、软件要求等。

## 准备操作系统

支持在下表所示的 Linux 操作系统中安装 OceanBase 数据库。

|       Linux操作系统       |    版本   |             服务器架构         |
|--------------------------|-----------|-------------------------------|
| Alibaba Cloud Linux      | 2   | x86_64，ARM_64 |
| 龙蜥 AnolisOS            | 8.6 及以上   | x86_64（包括海光），ARM_64（鲲鹏、飞腾）|
| KylinOS                  | V10         | x86_64（包括海光），ARM_64（鲲鹏、飞腾） |
| 统信 UOS                 | V20         | x86_64（包括海光），ARM_64（鲲鹏、飞腾）|
| 中科方德 NFSChina         | 4.0 及以上  | x86_64（包括海光），ARM_64（鲲鹏、飞腾）|
| 浪潮 Inspur kos           | 5.8        | x86_64（包括海光），ARM_64（鲲鹏、飞腾）|
| CentOS / Red Hat Enterprise Linux | 7.x、8.x   | x86_64（包括海光），ARM_64（鲲鹏、飞腾） |
| SUSE Enterprise Linux             | 12SP3 及以上 | x86_64（包括海光） |
| Debian                            | 8.3 及以上   | x86_64（包括海光） |
| openEuler                | 20.03 LTS SP1/SP2 和 22.10 LTS | x86_64（包括海光），ARM_64（鲲鹏、飞腾）|
| 凝思 LinxOS | V6.0.99、V6.0.100 | x86_64（包括海光），ARM_64（鲲鹏、飞腾） |

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>操作系统需要配置网络和软件管理器（ yum 或 zypper 源）。</p>
  </main>

## BIOS 设置

**特殊设置：**

* Numa 关闭（INTEL)

  >**说明**
  >
  >INTEL 环境建议修改配置文件 `/etc/sysctl.conf` 将参数 `vm.swappiness` 设置为 `0`，方法如下：
  >
  >```bash
  >[root@xxx /]
  >$vi /etc/sysctl.conf
  >vm.swappiness = 0
  >
  >[root@xxx /]
  >$sysctl -p    #应用 sysctl.conf 配置文件里的值
  >```

* Numa 开启（海光/AMD/鲲鹏/ARM)

  >**说明**
  >
  >ARM 和海光环境建议修改配置文件 `/etc/sysctl.conf` 将参数 `kernel.numa_balancing`、`vm.zone_reclaim_mode` 和 `vm.swappiness` 设置为 `0`，方法如下：
  >
  >```bash
  >[root@xxx /]
  >$vi /etc/sysctl.conf
  >kernel.numa_balancing = 0
  >vm.zone_reclaim_mode = 0
  >vm.swappiness = 0
  >
  >[root@xxx /]
  >$sysctl -p    #应用 sysctl.conf 配置文件里的值

**BIOS 需要关闭以下选项：**

* Cstate

* Pstate

* EIST

* Power saving

**BIOS 需要配置以下选项：**

* Automatic Power on After Power Loss: Always on

* Intel Virtualization Technology：开启

* Hyper-threading：开启

* Hardware prefetcher：开启

* VT-d：开启

* SR-IOV：开启

* Turbo Mode：开启

* Energy performance：开启最大 performance

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>不同的服务器修改 BIOS 的方式不同，具体操作请参见服务器操作手册。</p>
  </main>

## 磁盘挂载

* OCP 服务器的磁盘挂载点要求如下表所示。

  |    挂载点     |       大小       |     用途      |          磁盘格式           |
  |------------|----------------|-------------|-------------------------|
  | /home      | 100 GB\~300 GB | 各组件运行日志盘    | 建议 ext4 或 xfs |
  | /data/log1 | 内存大小的 3\~4 倍   | OCP 元数据库日志盘 | 建议 ext4 或 xfs |
  | /data/1    | 取决于所需存储的数据大小   | OCP 元数据库数据盘 | 建议 ext4 或 xfs |
  | /docker    | 200 GB\~500 GB | Docker 根目录  | 建议 ext4 或 xfs |

* OBServer 节点的磁盘挂载点要求如下表所示。

  |    挂载点     |       大小       |       用途       |         文件系统格式          |
  |------------|----------------|----------------|-------------------------|
  | /home      | 100 GB\~300 GB | observer 进程运行日志盘 | 建议 ext4 或 xfs |
  | /data/log1 | 内存大小的 3\~4 倍   | observer 进程日志盘   | 建议 ext4 或 xfs |
  | /data/1    | 取决于所需存储的数据大小   | observer 进程数据盘   | 建议 ext4 或 xfs |

* OMS 服务器的磁盘挂载点要求如下表所示。

  |    挂载点    |                          大小                          |       用途        | 文件系统格式  |
  |-----------|------------------------------------------------------|-----------------|---------|
  | /data/oms | 400 GB，取决于同步对象的大小、同步作业个数、同步对象 DML 操作的频率和 Store 保留的时间 | OMS Store 组件数据盘 | 建议 ext4 或 xfs |

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>建议根目录不小于 50 GB。如果使用 LVM，建议创建时使用条带化参数。示例如下：</p>
    <p><code>lvcreate -n data -L 3000G obvg --stripes=3 --stripesize=128</code></p>
  </main>

## 网卡设置

建议配置 2 块万兆网卡。

* bond 模式取名 bond0，mode1 或 mode4，推荐使用 mode4。对于 mode4 模式，交换机需要配置802.3ad。
* 网卡名建议使用 eth0、eth1。

## 软件要求

在部署 OAT 图形化界面、ODC 与 OMS 的机器需要安装 Docker，版本要求如下表所示。

|   软件  |         版本         |
|--------|---------------------|
| Docker | Docker CE 17.03 及以上 |
