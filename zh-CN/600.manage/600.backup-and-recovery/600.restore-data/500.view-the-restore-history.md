|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 查看物理恢复结果

恢复结束后，可以通过视图查看物理恢复结果。

## 操作步骤

1. 使用 `root` 用户登录集群的 `sys` 租户。

2. 待恢复完成后，您可以执行以下语句，查看集群的恢复任务结果。

   ```sql
   SELECT * FROM CDB_OB_RESTORE_HISTORY WHERE RESTORE_TENANT_NAME='OBT_NEW' AND TENANT_ID!=1\G
   ```

   查看结果示例如下：

   ```shell
   // RESTORE_TYPE：QUICK(快速恢复)，FULL(全量恢复)
   *************************** 1. row ***************************
                TENANT_ID: 1004
                        JOB_ID: 1
        RESTORE_TENANT_NAME: OBT_NEW
        RESTORE_TENANT_ID: 1004
        BACKUP_TENANT_NAME: OBT
        BACKUP_TENANT_ID: 1002
        BACKUP_CLUSTER_NAME: ob1
                BACKUP_DEST: file:///data/backup/data,file:///data/backup/archive
                RESTORE_SCN: 1726812641703722001
        RESTORE_SCN_DISPLAY: 2024-09-20 14:10:41.703722
                RESTORE_OPTION: pool_list=small_pool&method=quick
                RESTORE_TYPE: QUICK
       START_TIMESTAMP: 2024-09-20 14:11:14.158988
      FINISH_TIMESTAMP: 2024-09-20 14:12:13.285405
                STATUS: SUCCESS
     BACKUP_PIECE_LIST: file:///data/backup/archive/piece_d1002r1p1
       BACKUP_SET_LIST: file:///data/backup/data/backup_set_1_full
        BACKUP_CLUSTER_VERSION: 17180066816
              LS_COUNT: 3
       FINISH_LS_COUNT: 0
          TABLET_COUNT: 688
        FINISH_TABLET_COUNT: 688
           TOTAL_BYTES: 28120315
        TOTAL_BYTES_DISPLAY: 26.82MB
          FINISH_BYTES: 0
         FINISH_BYTES_DISPLAY: 0.00MB
           DESCRIPTION: NULL
               COMMENT:
    1 row in set
    ```

    ```sql
    SELECT * FROM DBA_OB_TENANTS WHERE TENANT_ID=1004\G
    ```
    
    结果如下：
    
    ```sql
    -- RESTORE_DATA_MODE：REMOTE(快速恢复的租户)，NORMAL(非快速恢复的租户)
    *************************** 1. row ***************************
                 TENANT_ID: 1004
               TENANT_NAME: OBT_NEW
               TENANT_TYPE: USER
               CREATE_TIME: 2024-09-20 14:11:16.474506
               MODIFY_TIME: 2024-09-20 14:12:22.448524
              PRIMARY_ZONE: RANDOM
                  LOCALITY: FULL{1}@z1, FULL{1}@z2, FULL{1}@z3
         PREVIOUS_LOCALITY: NULL
        COMPATIBILITY_MODE: MYSQL
                    STATUS: NORMAL
             IN_RECYCLEBIN: NO
                    LOCKED: NO
               TENANT_ROLE: STANDBY
         SWITCHOVER_STATUS: NORMAL
          SWITCHOVER_EPOCH: 0
                  SYNC_SCN: 1726812641703722001
            REPLAYABLE_SCN: 1726812641703722001
              READABLE_SCN: 1726812641703722001
        RECOVERY_UNTIL_SCN: 1726812641703722001
                  LOG_MODE: NOARCHIVELOG
        ARBITRATION_SERVICE_STATUS: DISABLED
                  UNIT_NUM: 1
                COMPATIBLE: 4.3.4.0
                 MAX_LS_ID: 1002
         RESTORE_DATA_MODE: REMOTE
    ```

    `CDB_OB_RESTORE_HISTORY` 视图中各字段基本与 `CDB_OB_RESTORE_PROGRESS` 相对应。其中，`COMMENT` 用于记录任务失败时的相关错误信息。

    如果恢复失败，您可以通过删除租户的方式来取消本次恢复，具体操作请参见 [取消恢复](../600.restore-data/300.cancel-a-restore.md)。

## 后续操作

物理恢复执行成功后，恢复后的租户均为备租户，您可执行如下操作:

* 执行 `recover` 命令, 作为备租户继续从源租户回放日志, 具体操作参见 [备租户日志回放](510.recover-the-standby-tenant.md)。

* 执行备切主命令，将备租户转换为主租户，具体操作参见 [备租户转为主租户](600.active-standby-tenant.md)。快速恢复不支持此功能。
