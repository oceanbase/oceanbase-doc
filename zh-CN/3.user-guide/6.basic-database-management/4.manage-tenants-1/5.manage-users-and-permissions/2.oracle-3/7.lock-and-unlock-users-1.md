# 锁定和解锁用户
#docslug#/oceanbase-database/oceanbase-database/V4.0.0/lock-and-unlock-users-1
当一个用户暂时不需要访问数据库，管理员可锁定该用户，被锁定的用户无法登录 OceanBase 数据库，管理员也可以解锁用户，重新激活被锁定的用户。

## 通过 SQL 语句锁定和解锁用户

您可以通过 `ALTER USER` 语句锁定和解锁用户。锁定和解锁用户的操作一般由管理员完成，普通用户若需要执行锁定和解锁操作，必须具备全局 `ALTER USER` 权限。执行锁定用户操作后，被锁定的用户将不允许登录。

查看当前拥有权限的操作请参见 [查看用户权限](../2.oracle-3/4.view-user-permissions.md)。如果您没有所需的权限，请联系管理员为您添加，为用户添加权限的相关操作请参见 [修改用户权限](../2.oracle-3/5.modify-user-permissions-1.md)。

锁定和解锁用户的 SQL 语句如下：

```sql
ALTER USER user {ACCOUNT LOCK | ACCOUNT UNLOCK};
```

示例：

* 锁定用户

  ```sql
  obclient> ALTER USER demo ACCOUNT LOCK ;
  Query OK, 0 rows affected
  
  obclient -udemo@demo0_111 -P2881 -h10.10.10.1   -p***1**
  obclient: [Warning] Using a password on the command line interface can be insecure.
  ERROR 3118 (HY000): User locked
  ```

* 解锁用户

  ```sql
  obclient> ALTER USER demo ACCOUNT UNLOCK ;
  Query OK, 0 rows affected
  
  obclient -udemo@demo0_111 -P2881 -h10.10.10.1   -p***1**
  obclient: [Warning] Using a password on the command line interface can be insecure.
  Welcome to the OceanBase monitor.  Commands end with ; or \g.
  Your OceanBase connection id is 3221894166
  Server version: 5.7.25
  
  Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.
  
  Oracle is a registered trademark of Oracle Corporation and/or its
  affiliates. Other names may be trademarks of their respective
  owners.
  
  Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
  ```

执行锁定和解锁用户的操作后，您可以通过查询 `ALL_VIRTUAL_USER_REAL_AGENT` 表中的 `is_locked` 字段来确认用户的锁定状态。如果 `is_locked` 字段的值为 `1` ，则表示用户为锁定状态；如果 `is_locked` 字段的值为 `0`，则表示用户为解锁状态。

示例如下：

```sql
obclient> SELECT user_name,is_locked FROM ALL_VIRTUAL_USER_REAL_AGENT WHERE user_name='DEMO';
+-----------+-----------+
| USER_NAME | IS_LOCKED |
+-----------+-----------+
| DEMO      |         1 |
+-----------+-----------+
1 row in set
```

更多 `ALTER USER` 语句的信息请参见 [ALTER USER](../../../../../4.development-guide-refactoring-1/6.sql-syntax/3.common-tenant-oracle-mode/9.sql-statement-1/1.DDL-1/12.alter-user-1.md)。


