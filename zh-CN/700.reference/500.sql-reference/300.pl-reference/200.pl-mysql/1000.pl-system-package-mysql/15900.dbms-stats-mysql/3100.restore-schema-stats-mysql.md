| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |

# RESTORE_SCHEMA_STATS

`RESTORE_SCHEMA_STATS` 过程用于恢复指定时刻的 Schema 级别历史统计信息。

## 语法

```sql
DBMS_STATS.RESTORE_SCHEMA_STATS(
  ownname                VARCHAR2,
  as_of_timestamp        TIMESTAMP WITH TIME ZONE,
  force                  BOOLEAN DEFAULT FALSE,
  no_invalidate          BOOLEAN DEFAULT FALSE);
```



## 参数说明

|       参数        |           说明            |
|-----------------|-------------------------|
| ownname         | Schema 名称。              |
| as_of_timestamp | 指定恢复时间。                 |
| force           | 强制恢复，并忽略加锁。默认是 `FALSE`。 |
| no_invalidate   | 收集统计信息时是否刷 Plan Cache。设置为 `TRUE` 表示收集统计信息时不刷 Plan Cache。    |



## 异常情况

|    错误码    |         描述       |
|-----------|---------------------|
| HY000     |  <ul><li>该对象不存在或权限不足。</li><li>无效或不一致的值。</li><li>统计信息无法恢复，统计历史信息不可用。</li></ul>     |

## 使用说明

要调用此过程，您必须是表的所有者。对于 `SYS` 拥有的对象，需要是表的所有者或具有 `SYSDBA` 权限才能调用此过程。

## 示例

指定恢复 `hr` Schema 下某个时刻下的统计信息。

```sql
obclient [hr]> CALL DBMS_STATS.RESTORE_SCHEMA_STATS ('hr', '2021-09-26 19:02:12.675729');
Query OK, 0 rows affected
```
