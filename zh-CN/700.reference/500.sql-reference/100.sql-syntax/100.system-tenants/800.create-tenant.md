# CREATE TENANT

## 描述

`CREATE TENANT` 语句用于创建用户租户。OceanBase 数据库仅支持创建用户租户，系统租户为集群创建时系统自动创建；Meta 租户是 OceanBase 数据库内部自管理的租户，每创建一个用户租户会创建一个对应的 Meta 租户，其生命周期与用户租户保持一致。

通过 `CREATE TENANT` 语句创建的租户，默认其租户角色为 `PRIMARY`。

## 使用限制及注意事项

* OceanBase 数据库支持两种类型的租户，MySQL 兼容模式和 Oracle 兼容模式。创建租户时，需要指定合适的租户的类型。租户创建后，租户类型无法修改。

* 创建租户时需要为租户分配资源池，需要提前做好资源规划并创建好资源池，创建资源池的相关操作请参见 [创建租户](../../../../600.manage/200.tenant-management/600.common-tenant-operations/200.manage-create-tenant.md)。

## 权限要求

仅 `sys` 租户的 `root` 用户（`root@sys`）可以创建租户，其他租户不支持创建租户。

## 语法

创建租户的语法如下：

```sql
CREATE TENANT [IF NOT EXISTS] tenant_name 
     [tenant_option_list] [set_sys_var];

tenant_option_list: 
  tenant_option [, tenant_option...]

tenant_option:  
      LOCALITY [=] 'locality_description' [FORCE] 
    | PRIMARY_ZONE [=] primary_zone_name 
    | RESOURCE_POOL_LIST [=] (resource_pool_list) 
    | ENABLE_ARBITRATION_SERVICE [=] {True | False} 
    | {CHARACTER SET | CHARSET} [=] charset_name 
    | COLLATE [=] collation_name 
    | {READ ONLY | READ WRITE}
    | [DEFAULT] TABLEGROUP [=] {NULL | tablegroup_name} 
    | PROGRESSIVE_MERGE_NUM [=] INTNUM 
    | ENABLE_EXTENDED_ROWID [=] {true | false} 
    | COMMENT [=] 'string' 

resource_pool_list:
      pool_name [, pool_name...]

set_sys_var:
       {SET | SET VARIABLES | VARIABLES} var_name {TO | =} var_value [,var_name {TO | =} var_value...]
```

## 参数说明

|          参数            |                描述                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------|
| tenant_name              | 指定租户名。最长 128 个字符，只能为大小写英文字母，数字和下划线，而且必须以字母或下划线开头，并且不能是 OceanBase 数据库的关键字。 |
| IF NOT EXISTS            | 如果要创建的租户名已存在，并且没有指定 `IF NOT EXISTS`，则会报错。    |
| LOCALITY                 | 描述副本在 Zone 间的分布情况。 例如：`F@z1,F@z2,F@z3` 表示 `z1`、`z2`、`z3` 为全功能副本。     |
| PRIMARY_ZONE             | 指定租户所在的 Primary Zone。主要支持以下几种取值或格式：<ul><li>`RANDOM`：指定租户的 Primary Zone 为租户所在的所有 Zone，表示租户所在的所有 Zone 具有相同的优先级。</li> <li>zone_name：指定租户的 Primary Zone 为具体的某个 Zone。</li></ul> </br>如果创建租户时未指定 Primary Zone，则默认取值为 `RANDOM`。 |
| RESOURCE_POOL_LIST       | 指定分配给租户的资源池列表，创建租户时必须指定该参数。</br>如果有多个资源池，要求多个资源池的 `UNIT_NUM` 个数一致。<main id="notice" type='notice'><h4>注意</h4><p>同一个租户的多个资源池，其对应的 `ZONE_LIST` 相互之间不允许有交集。</p></main> |
| ENABLE_ARBITRATION_SERVICE | 指定租户是否开启仲裁服务，如果不指定，默认值为 `False`。对于集群中有仲裁服务的场景，如果创建租户时未开启仲裁服务，可以在创建租户后再开启仲裁服务，详细操作请参见 [为租户开启仲裁服务](../../../../600.manage/400.high-availability/400.arbitration-high-availability/200.enable-the-arbitration-service.md)。|
| CHARACTER SET \| CHARSET | 指定租户级的字符集，有关字符集的详细介绍，请参见 [字符集（MySQL 模式）](../200.common-tenant-of-mysql-mode/100.basic-elements-of-mysql-mode/300.character-set-and-collation-of-mysql-mode/200.character-set-of-mysql-mode.md) 和 [字符集（Oracle 模式）](../300.common-tenant-of-oracle-mode/300.basic-elements-of-oracle-mode/1000.character-set-and-collation-of-oracle-mode.md)。   |
| COLLATE                  | 指定租户级的字符序，有关字符序的详细介绍，请参见 [字符序（MySQL 模式）](.../200.common-tenant-of-mysql-mode/100.basic-elements-of-mysql-mode/300.character-set-and-collation-of-mysql-mode/300.collation-of-mysql-mode.md) 和 [字符序（Oracle 模式）](../300.common-tenant-of-oracle-mode/300.basic-elements-of-oracle-mode/1000.character-set-and-collation-of-oracle-mode.md)。  |
| READ ONLY \| READ WRITE  | 指定租户的属性为只读还是读写。如果不指定，默认为读写属性。|
| [DEFAULT] TABLEGROUP     | 指定租户默认表组信息，`NULL` 表示取消默认表组。 如果不指定，则默认为 `NULL`。    |
| PROGRESSIVE_MERGE_NUM    | 指定新建一张表时默认对表数据进行渐进合并的次数。如果不指定，则系统默认会将其值设置为租户级配置项 `default_progressive_merge_num` 的值。有关租户级配置项 `default_progressive_merge_num` 的更多介绍，请参见 [default_progressive_merge_num](../../../800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/1400.default_progressive_merge_num.md)。|
| ENABLE_EXTENDED_ROWID    | 指定是否将表创建为 Extended ROWID 模式。如果不指定，则系统默认会将其值设置为租户级配置项 `default_enable_extended_rowid` 的值。有关租户级配置项 `default_enable_extended_rowid` 的更多介绍，请参见 [default_enable_extended_rowid](../../../800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/4700.default_enable_extended_rowid.md)。|
| set_sys_var              | 指定租户级的系统变量值。其中：<ul><li>`ob_compatibility_mode`：用于指定租户的兼容模式（可选 MySQL 或 Oracle 模式），而且只能在创建时指定；如果不指定 `ob_compatibility_mode`，则默认兼容模式为 MySQL；</li> <li>`lower_case_table_names`：用于控制大小写敏感，仅支持使用 `CREATE TENANT` 语句创建租户时指定并只在 MySQL 模式下生效，租户创建后不能通过 SQL 语句修改。</li></ul> |
| COMMENT                  | 填写注释。   |

## 示例

* 创建一个 3 副本的 MySQL 租户。

  ```sql
  obclient> CREATE TENANT IF NOT EXISTS test_tenant CHARSET='utf8mb4', ZONE_LIST=('zone1','zone2','zone3'), PRIMARY_ZONE='zone1;zone2,zone3', RESOURCE_POOL_LIST=('pool1');
  ```

* 创建 Oracle 兼容模式租户。

  ```sql
  obclient> CREATE TENANT IF NOT EXISTS tenant1 ZONE_LIST=('zone1'), PRIMARY_ZONE='zone1', RESOURCE_POOL_LIST=('pool1') SET ob_compatibility_mode='oracle', set ob_tcp_invited_nodes='%';
  ```
	
## 相关文档

* [租户介绍](../../../../600.manage/200.tenant-management/100.tenant-introduction.md)

* [用户租户介绍](../../../../600.manage/200.tenant-management/400.introduction-of-user-tenant.md)

* [创建租户](../../../../600.manage/200.tenant-management/600.common-tenant-operations/200.manage-create-tenant.md)


