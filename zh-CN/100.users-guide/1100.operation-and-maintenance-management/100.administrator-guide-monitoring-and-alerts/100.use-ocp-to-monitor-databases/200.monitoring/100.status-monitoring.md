# 状态监控

OCP 的集群概览和总览页面分别展示了 OceanBase 集群的状态监控信息。

## 前提条件

登录前请确认您具备集群的管理权限或只读权限，否则无法查看集群概览数据。有关权限的详细介绍，请参见《 OCP 用户指南》中的 **OCP 默认角色** 。有关权限的具体操作请参见《 OCP 用户指南》中的 **创建用户** 。

## 操作步骤

1. 登录 OCP 。

2. 在左侧导航栏单击 **集群** ，进入 **集群** 页面。

   **集群** 页面展示了当前登录用户下的集群概览信息，包括： **性能指标 Top5** 、 **集群合并时间 Top5** 、 **机器资源** 、 **资源水位** 和 **集群列表** 。

3. 查看集群概览信息：

   * 性能指标 Top5

     展示了某个时间段内某个性能指标的和从大到小排序最大的 5 个集群。您可以根据业务需要，选择待查看的性能指标和对应的时间范围。单击右上角图标，可对图标进行放大查看。

     ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2965260261/p264657.png)

      可选择的时间范围包括： **最近一小时** 、 **最近一天** 和 **最近一周** 。
      可选择的性能指标包括： **QPS** 、 **查询响应时间** 、 **活跃会话数** 和 **CPU 使用率** 。各指标的含义如下表所示：

     |     性能指标      |    含义    |
     |-------------|--------------------------------------|
     | QPS（time/s） | Query Per Second，当前 OCP 管理的集群的每秒查询率。 |
     | 查询响应时间（us）  | 显示集群的平均查询响应时间。         |
     | 活跃会话数       | 显示单位时间内的活跃会话总数。        |
     | CPU 使用率（%）  | 显示集群内 CPU 使用率的平均值。     |

      > **说明**
      >
      > 当某个集群中的某个性能指标值激增，可在该集群中的 性能监控 页面，通过关联关系找到指标值激增的租户，进一步确定指标值激增的主机。详细信息请参见 [性能监控](../../../../900.performance-tuning-guide/600.performance-diagnostics/300.obproxy-performance-monitoring.md)。
   * 集群合并时间 Top5

     以柱状图的形式展示了最近三天内合并时间平均值从大到小排序最大的 5 个集群。合并操作（Major freeze）是将动静态数据做归并，会比较费时。当转储产生的增量数据积累到一定程度时，通过 Major freeze 实现大版本的合并。

     如果最近三天内没有集群合并，则此处为空。单击右上角图标，可对图标进行放大查看。

     ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2965260261/p264757.png)

   * 机器资源

     展示了 机房名、机器总数 和已经部署了的 OBServer 数量，可以为集群扩容提供参考。

     ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2965260261/p264760.png)

   * 资源水位

     展示了集群的名称、租户数量、已分配 CPU 、已分配内存和磁盘已使用量。支持根据已分配 CPU 、已分配内存和磁盘已使用量对集群进行排序。

     ![07021646](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6765745261/p291083.png)

     单击各集群的集群名称，可以跳转到集群详情页面，详情参见《 OCP 用户指南》。

   * 集群列表

     展示了各集群的 **集群名** 、 **ID** 、 **版本** 、 **部署模式** 、 **状态** 、 **创建时间** 和 **告警信息** 等。

     对于主备库集群，默认只显示主集群的信息，单击左侧的 **+** 图标可以查看备集群的信息。

     ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2965260261/p264775.png)

     单击某个集群名，进入该集群的 **总览** 页面。 **总览** 页面包含了该集群的基础信息、 **资源水位** 、 **告警概览** 、 **最近 7 天系统事件** 、 **Zone 列表** 和 **OBServer 列表** 。

     * **查看基础信息**

       您可在集群总览页面查看集群基础信息，包括 **集群类型、OB 版本号、Region 数量、Zone 部署、硬件架构、机器数量、分区数、租户数量、创建者、OBProxy 集群 、日志传输模式、同步状态、保护模式、软件安装路径、数据盘路径、日志盘路径** 和 **ConfigUrl** 等信息。![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4495080261/p272910.png)

       > **说明**
       >
       > 如果您还没有关联 OBProxy 集群，可以单击 关联 OBProxy 集群 为集群添加 OBProxy 服务。

       |     参数     |    说明     |
       |------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
       | 集群类型       | 分为 **主集群** 和 **备集群** 。  |
       | OB 版本号     | 当前集群的 OceanBase 数据库版本号。 |
       | Region 数量  | 当前集群的 Region 数量。        |
       | Zone 部署    | 当前集群的部署模式。 </br>当 Zone 部署为 1 时，表示该集群有一个 Zone ，该 Zone 下有一台主机。 </br>当 Zone 部署为 1-1 时，表示该集群有两个 Zone，每个 Zone 下有一台主机。 </br>当 Zone 部署为 N-N-...N(M 个 N）时，表示该集群有 M 个 Zone，每个 Zone 下有 N 台主机。        |
       | 硬件架构       | 添加主机时，OCP 会自动识别主机的硬件架构，当前主集群和备集群硬件架构不同的部署方式。        |
       | 机器数量       | 当前集群的主机数量 |
       | 分区数        | 当前集群的表的分区数。             |
       | 租户数量       | 当前集群的租户数量。              |
       | 创建者        | 创建当前集群的用户名称。            |
       | OBProxy 集群 | 显示当前 OceanBase 集群关联的 OBProxy 集群。<ul><li>没有关联的 OBProxy 集群时，单击 **关联 OBProxy 集群** 可以关联 OBProxy 集群，支持同时绑定多个 OBProxy 集群。</li> <li>有关联的 OBProxy 集群时，可以单击编辑图标，可添加或删除 OBProxy 集群。</li></ul>    |
       | 保护模式       | 当集群类型为主集群时显示。           |
       | 软件安装路径     | 显示创建集群时填写的路径。           |
       | 数据盘路径      | 显示创建集群时填写的路径。           |
       | 日志盘路径      | 显示创建集群时填写的路径。           |
       | 日志传输模式     | 当集群类型为备集群时显示，分为同步传输和异步传输。当传输模式为同步时，同步状态可为异步，与保护模式有关。              |
       | 同步状态       | 当集群类型为备集群时显示，显示传输日志的延时时长。             |
       | ConfigUrl  | 当前集群的 Url，可单击复制图标，复制 ConfigUrl 。      |

     * **资源水位**

       您可在资源水位区域查看当前集群的 **CPU 剩余、内存剩余** 和 **磁盘剩余** 。并根据当前资源水位对集群进行管理。

       ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9956530261/p264933.png)

     * **查看告警概览**

       您可在告警概览区域对当前集群的告警进行查看，您可查看 **最近 24 小时、最近一周、最近 30 天** 时间内的告警情况，包括： **停服、严重、警告、注意** 和 **提醒** 不同等级的告警，您可单击对应告警后的数字进入告警事件页面，查看详细告警信息。

       ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9956530261/p264934.png)

     * **查看最近 7 天 系统事件**

       您可在 **最近 7 天系统事件** 中根据实际需要设置查询条件，查看最近七天内的系统事件。

       * 如图中 ① 处可设置搜索时间。

       * 如图中 ② 处可设置搜索的事件名。

       * 如图中 ③ 处可根据开始时间对事件进行生序或降序的排列。

       系统将会综合以上设置的条件，在列表中展示您想查看的系统事件。

       ![06101753](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6965745261/p282977.png)

     * **查看 Zone 列表**

       您可在 Zone 列表中搜索并查看 Zone 的名称、 **所属 Region、所在机房、机器数量、Root Server** 和 **状态** 。并可在当前 Zone 中进行 **添加 OBServer、重启、停止** 和 **删除** 的操作。详情参见 《OCP 用户指南》。

       ![1](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0066530261/p264941.png)

     * **查看 OBServer 列表**

       您可在 OBServer 列表中查看 **IP、端口、所在机房、所属 Zone、机型、剩余资源** 和 **状态** ，并进行 **重启、停止、替换、删除** 和 **下载日志** 的操作。详情参见 《OCP 用户指南》。

       ![09081044](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4106591361/p324556.png)
