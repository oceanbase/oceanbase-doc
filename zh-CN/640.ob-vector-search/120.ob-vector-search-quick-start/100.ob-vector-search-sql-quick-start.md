| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |

# 使用 SQL 快速进行向量检索

OceanBase 支持使用 SQL 语言进行向量检索，本文介绍了快速上手方法。

## 注意事项

* 目前向量检索为实验特性。

* 向量检索仅支持 MySQL 租户模式。

## 快速上手

### 启用向量检索功能

```sql
ALTER SYSTEM SET ob_vector_memeory_limit_percentage = 30;
```

该配置项的具体数值需要根据您的内存占用情况来规划，内存计算方式请参见 [ob_vector_memeory_limit_percentage](../../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/8600.ob_vector_memory_limit_percentage.md)。

### 创建向量列和索引

<main id="notice" type='notice'>
  <h4>注意</h4>
  <p>一张表中只能定义一个维度的数据。</p>
</main>

创建向量列 `c2`，向量数据维度为 `3`。创建向量索引必须指定索引参数，至少需要提供 `type` 和 `distance` 两个参数。

```sql
CREATE TABLE t1(
    c1 INT,
    c2 VECTOR(3),
    PRIMARY KEY(c1),
    VECTOR INDEX idx1(c2) WITH (distance=L2, type=hnsw)
    );
```

### 写入向量数据

```sql
INSERT INTO t1 VALUES(1, '[0.203846, 0.205289, 0.880265]');
INSERT INTO t1 VALUES(2, '[0.735541, 0.670776, 0.903237]');
INSERT INTO t1 VALUES(3, '[0.327936, 0.048756, 0.084670]');
```

### 执行向量检索

使用近似最近邻查询：

```sql
SELECT * FROM t1 ORDER BY l2_distance(c2, [0.712338, 0.603321, 0.133444]) APPROXIMATE LIMIT 1;
```

## 相关文档

* 向量数据详细说明请参见[向量数据](../700.ob-vector-search-reference/100.ob-vector-data-type.md)。

* 建表后创建向量索引、删除索引方法请参见[向量索引](../700.ob-vector-search-reference/300.ob-vector-index.md)。
