删除资源池
==========================

OceanBase 数据库支持通过 SQL 语句删除不再使用的资源池。

前提条件
-------------------------

删除资源池前，请确认该资源池当前未被任何租户使用。如果资源池正在被租户使用，则需要将资源池从租户中移除后再删除资源池，从租户中移除资源池的相关操作请参见 [从租户中移除资源池](../5.manage-resource-pools/5.remove-a-resource-pool-from-a-tenant.md)。

删除资源池
--------------------------

删除资源池的语句如下：

```sql
obclient> DROP RESOURCE POOL pool_name;
```

该语句仅支持由 `sys` 租户的管理员执行。

示例：

1. 使用 `root` 用户登录到数据库的 `sys` 租户。

2. 执行以下命令，查看待删除的资源池 `resource_pool1` 是否被租户使用。

   ```sql
   obclient> SELECT tenant_id,tenant_name FROM oceanbase.gv$unit WHERE resource_pool_name='resource_pool1';
   +-----------+-------------+
   | tenant_id | tenant_name |
   +-----------+-------------+
   |      NULL | NULL        |
   |      NULL | NULL        |
   +-----------+-------------+
   2 rows in set
   ```

   确认未被租户使用。

3. 执行以下命令，删除资源池。

   ```sql
   obclient> DROP RESOURCE POOL resource_pool1;
   Query OK, 0 rows affected
   ```

4. 删除完成后，可以执行以下语句，确认是否删除成功。

   ```sql
   obclient> SELECT * FROM oceanbase.__all_resource_pool;
   +----------------------------+----------------------------+------------------+------------------------+------------+----------------+-------------+-----------+--------------+--------------------+
   | gmt_create                 | gmt_modified               | resource_pool_id | name                   | unit_count | unit_config_id | zone_list   | tenant_id | replica_type | is_tenant_sys_pool |
   +----------------------------+----------------------------+------------------+------------------------+------------+----------------+-------------+-----------+--------------+--------------------+
   | 2021-11-11 14:29:24.849909 | 2021-11-11 14:29:24.854242 |                1 | sys_pool               |          1 |              1 | zone1       |         1 |            0 |                  0 |
   | 2021-11-11 14:43:01.455415 | 2021-11-11 14:43:01.466884 |             1002 | pool_Oracle_zone1_rhf  |          1 |           1002 | zone1       |      1002 |            0 |                  0 |
   | 2021-11-15 11:25:48.384105 | 2021-11-15 11:25:48.406186 |             1003 | pool_MySQL_zone1_zlz   |          1 |           1003 | zone1       |      1003 |            0 |                  0 |
   | 2021-11-15 11:26:38.986014 | 2021-11-15 11:26:38.997594 |             1004 | pool_MySQL1_zone1_cey  |          1 |           1004 | zone1       |      1004 |            0 |                  0 |
   | 2021-11-15 11:27:42.454288 | 2021-11-15 11:27:42.467915 |             1006 | pool_Oracle1_zone1_dfl |          1 |           1006 | zone1       |      1006 |            0 |                  0 |
   | 2021-11-17 14:38:03.945051 | 2021-11-17 14:38:03.945051 |             1022 | zyc_1117               |          1 |           1023 | zone1;zone2 |        -1 |            0 |                  0 |
   +----------------------------+----------------------------+------------------+------------------------+------------+----------------+-------------+-----------+--------------+--------------------+
   6 rows in set
   ```

   查询结果中没有 `resource_pool1`，则表示资源池删除成功。
