租户性能监控
===========================

您可以通过 OCP 查看租户的性能监控。

操作步骤
-------------------------

1. 登录 OCP。

2. 选择 **租户** ，进入 **租户** 界面。

3. 在 **租户列表** 区域，选择待操作的租户并单击其租户名。

4. 在显示的页面的左侧导航栏上，单击 **性能监控** 。

5. 在 **数据筛选** 区域，通过如下方式查看性能数据。

   筛选条件说明如下标所示：

   |    **过滤条件**    |                                                                              **描述**                                                                               |
   |----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | 选择时间（实时模式下不展示） | 选择某一段时间范围，用于返回这段时间范围内的数据。                                                                                                                                         |
   | 统计周期（实时模式下不展示） | 主要用于计算每个点数据的统计周期，支持按 **每分钟** 和 **每秒** 统计，分别对应了每分钟一个点或每秒钟一个点，OCP 同时也会根据选择的时间区间再去计算一个统计周期。 计算的规则是使返回的数据接近 1440 个点，如果选择的时间区间比较长，可能会出现统计周期大于 1 分钟的情况。 |
   | Zone           | 选择待查看的 Zone 。                                                                                                                                                     |
   | OBServer       | 选择待查看的 OBServer 。                                                                                                                                                 |

   * 输入过滤条件后，系统按 **选择的时间** 及 **统计周期** 展示性能监控数据。![06091755](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7113323261/p282520.png)

     **说明**

     如需查看某一时间段内的详细趋势，可鼠标拖拽选中该区域，系统会放大显示该区域的趋势信息，双击该趋势图可恢复。

   * 打开 **实时** 开关并选择需查看的 OBServer，系统实时展示该 OBServer 的性能数据。![06091759](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7113323261/p282527.png)

6. 切换页签，分别查看集群的 **性能与 SQL** 、 **事务** 、 **存储与缓存** 的性能监控数据。

   * 单击 **性能与 SQL** 页签，查看 SQL 执行相关的性能。性能与 SQL 相关的监控项可参考下表理解。

     |     监控项      |                                                                                                                                                                                                                                   说明                                                                                                                                                                                                                                   |
     |--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
     | QPS          | 平均每秒处理 SQL 语句数 *all: 每秒处理 SQL 语句数 (times/s)* select: 每秒处理 Select 语句数 (times/s)   *insert: 每秒处理 Insert 语句数 (times/s)* update: 每秒处理 Update 语句数 (times/s)   *replace: 每秒处理 Replace 语句数 (times/s)* delete: 每秒处理 Delete 语句数 (times/s)    |
     | 响应时间         | 响应时间 *all: 服务端每条 SQL 语句平均处理耗时 (us)* select: 服务端每条 Select 语句平均处理耗时 (us)   *insert: 服务端每条 Insert 语句平均处理耗时 (us)* update: 服务端每条 Update 语句平均处理耗时 (us)   *replace: 服务端每条 Replace 语句平均处理耗时 (us)* delete: 服务端每条 Delete 语句平均处理耗时 (us)        |
     | 活跃会话数        | 活跃的会话数量（个）                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
     | SQL 执行计划类别   | SQL 执行计划类别 *local: 每秒处理本地执行数 (times/s)* remote: 每秒处理远程执行计划数 (times/s)   * distributed: 每秒处理分布式执行计划数 (times/s)                                                                                                                                                                                                                                  |
     | 等待事件         | 每秒等待事件次数 (times/s)                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
     | 等待事件耗时       | 等待事件平均耗时 (us)                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
     | 请求等待队列       | 每秒 SQL 进入等待队列个数 (times/s)                                                                                                                                                                                                                                                                                                                                                                                                                                              |
     | 请求等待队列耗时     | SQL 请求在等待队列中的等待耗时 (us)                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
     | CPU 使用率      | CPU使用率 (%)                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
     | MemStore 使用率 | MemStore 使用率 (%)                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
     | Rpc 包耗时      | Rpc 收、发包耗时 *in: Rpc 收包平均耗时 (us)* out: Rpc 发包平均耗时 (us)                                                                                                                                                                                                                                                                                                                           |
     | Rpc 包吞吐量     | 单位时间内 Rpc 收、发包 byte 数据量 *in: Rpc 收包吞吐量 (byte)* out: Rpc 发包吞吐量 (byte)                                                                                                                                                                                                                                                                                                            |

   * 单击 **事务** 页签，查看事务相关的性能。事务相关的监控项可参考下表理解。

     |  监控项   |          说明          |
     |--------|----------------------|
     | TPS    | 平均每秒处理事务数，单位：次/s。    |
     | 事务响应时间 | 服务端每个事务平均处理时间，单位：us。 |
     | 事务日志数  | 每秒提交的事务日志数（次/s）      |
     | 事务日志量  | 每秒提交的事务日志大小 （byte）   |
     | 事务日志耗时 | 服务端处理事务日志的平均耗时（us）   |
     | 锁等待    | 每秒事务锁等待次数            |
     | 等锁耗时   | 每个锁等待平均耗时（us）        |

   * 单击 **存储与缓存** 页签，查看存储与缓存相关的性能。存储与缓存相关的监控项可参考下表理解。

     |   监控项    |                                                                                                                                           说明                                                                                                                                           |
     |----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
     | MemStore | 当前租户可写入数据内存 *total: MemStore 总大小 (MB)* active: 活跃 MemStore 大小 (MB)   *trigger: 触发合并阈值 (MB)* limit: MEMStore的limit (MB)    |
     | IOPS     | 平均每秒 IO 次数 *read: SSStore 每秒读次数 (times/s)* write: SSStore 每秒写次数 (times/s)                                                                                                                       |
     | IO 耗时    | 平均每次 IO 耗时 *read: SSStore 每次读取平均耗时 (us)* write: SSStore 每次写入平均耗时 (us)                                                                                                                           |
     | IO 吞吐量   | 平均每秒 IO 数据量 *read: SSStore 每秒读取数据量 (byte)* write: SSStore 每秒写入数据量 (byte)                                                                                                                        |
     | 缓存大小     | 缓存大小 *block_cache: 块缓存大小 (MB)* row_cache: 行缓存大小 (MB)   * plan_cache: 执行计划缓存大小 (MB)                                                                             |
     | 缓存命中率    | 缓存命中率 *block_cache: 块缓存命中率 (%)* row_cache: 行缓存命中率 (%)   * plan_cache: 执行计划缓存命中率 (%)                                                                            |
